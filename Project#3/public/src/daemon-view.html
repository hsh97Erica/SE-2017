<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<script src="../bower_components/webcomponentsjs/webcomponents-lite.js"></script>
<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="shared-styles.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../bower_components/digital-clock/digital-clock-mylt.html">
<link rel="import" href="../bower_components/paper-weather/paper-weather.html">
<link rel="import" href="../bower_components/paper-fab/paper-fab.html">
<link rel="import" href="../bower_components/neon-text-board/neon-ordered-text-board.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../bower_components/paper-card/paper-card.html">
<link rel="import" href="./electricflower/electricflower-polymer.html">
<link rel="import" href="notice-view.html">
<style type="text/css">
   @font-face { font-family: "myFirstFont"; 
       font-style: normal;
       src: url('SubwayTicker.otf');
        }
         h1 {
  font-family: myFirstFont;
  font-size: 300%;
  }
  </style>
<dom-module id="daemon-view">
  <template>
    <style include="shared-styles">
      :host {
        display: block;

        padding: 10px;
      }
    </style>
    <style>
  paper-input {
    max-width: 400px;
    margin: auto;
  }
  iron-icon, div[suffix] {
    color: hsl(0, 0%, 50%);
    margin-right: 12px;
  }
</style>

<style is="custom-style">
  .flex-horizontal {
    @apply(--layout-horizontal);
  }
  .flexchild {
    @apply(--layout-flex);
  }
  .flex-vertical {
    @apply(--layout-vertical);
    /*height: 220px;*/
  }
  .flexchild-vertical {
    @apply(--layout-flex);
  }
  .flex-end-justified {
    @apply(--layout-horizontal);
    @apply(--layout-end-justified);
  }
  #container {
    display: flex;
  }
  </style>
  
    <div class="card">
      <div id="backgrd" style="position: relative; height:900px; width:100%">
      <iframe src="electricflower/electricflower.html" scrolling="no" style="width:100%;height:100%;  overflow:hidden;"></iframe>
      </div>
      <div id="daemuncontent" style="position: relative;  left:10px; top: -900px;margin-bottom:-800px">
      <!--<electricflower-polymer ></electricflower-polymer>-->
      <div class="container flex-vertical">
        <div>
        <center style="height:180px">
          <div style="position: relative;">
           <img style="width: 100% ;" height="100%" src="./images/bg.png"/>
           </div>
           <div style="position: relative; left:10px; top: -165px;">
        <digital-clock ></digital-clock>
           </div>
        </center>
       
      </div>
      <div style="height:50px;  border-radius: 10px;background: rgba(255, 255, 255, 0.8);">
        <div style=" display: inline-block;">실시간 검색상위:
          
         <neon-ordered-text-board style=" display: inline-block" id="rn" values="{{naverrankes}}"></neon-ordered-text-board>
         </div>
      </div>
      
      <div class="container flex-horizontal" style="margin-top: 3%;">
        <paper-weather style="width:45%" unit="c" hide-forecast="true" show-extra-data="[[showExtraData]]" location="[[location.0]]"></paper-weather>
        <paper-weather style="width:45%" unit="c" hide-forecast="true" show-extra-data="[[showExtraData]]" location="[[location.1]]"></paper-weather>
      </div>
      <div>
        
        <notice-view style="margin-top: 3%; background: rgba(255, 255, 249, 0.8);"></notice-view>
      </div>
      </div>
    </div>
    </div>
   <!-- <div >
    
      <paper-fab icon="settings"></paper-fab>
      
      </div>-->
  </template>

  <script>
    Polymer({
      is: 'daemon-view',
      ready: function(){
        this._getNaverRankData();
        setInterval(this._getNaverRankData.bind(this), 60*1000);
      },
      properties:{
        location:{
          type:Array,
          value: ["ansan","seoul"],//["Santa Barbara, CA",'los angeles, ca'],
        },
        naverrankes:{
          type:Array,
          notify:true,
          value: function(){
            return ['unknown'];
          }
        },
        naverranktraversal:{
          type:Object,
          value: undefined,

        }
      },
      _getNaverRankData: function(){
         var ajx = document.createElement('iron-ajax');
        ajx.handleAs='json';
        ajx.method='get';
        ajx.url = '/addons/naverrank.json';
        var req = ajx.generateRequest();
        var self = this;
        req.completes.then(function(res) {
          if(self.naverranktraversal!=undefined){
              clearInterval(self.naverranktraversal);
              self.naverranktraversal=undefined;
              //alert("clear work");
          }
          const numbereditem = [];
          const resp = res.response;
          for(i=0;i<resp.length;i++){
            
            numbereditem.push((i+1)+". "+resp[i]);
          }

          self.naverrankes = numbereditem;
          //this._showNextNaverRank();
          //alert(self.naverrankes[0]);
          self.naverranktraversal=setInterval(self._showNextNaverRank.bind(self),3*1000);  
          
        self.$.rn.moveToFirst();
      });
        
      },
      _showNextNaverRank:function(){
        this.$.rn.next();
      },
    });
  </script>
</dom-module>
